<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Dockerized R studio/bioconductor on AWS.</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Aws projects</h1>
          <h2>Working through infrastructure stuff</h2>
        </header>

        <section id="main_content">
          <h3>
<a id="r-studiobioconductor-on-aws" class="anchor" href="#r-studiobioconductor-on-aws" aria-hidden="true"><span class="octicon octicon-link"></span></a>R studio/bioconductor on AWS.</h3>

<p>The goal is to learn AWS container service so I can run <a href = "https://www.bioconductor.org/help/docker/">Bioconductor's Docker containerized</a> R Studio Server on an AMI and work from anywhere.</p>

<p>Some reading to do:
<ul>
<li><a href = "https://blogs.aws.amazon.com/bigdata/post/Tx3IJSB6BMHWZE5/Running-R-on-AWS">Running R on AWS</a></li>
<li><a href = "http://docs.aws.amazon.com/AmazonECS/latest/developerguide/ECS_GetStarted.html">Getting Started with Amazon ECS</a></li>
</ul>
</p>

<p>How I'm doing it:
<dl>
<dt><a href="http://docs.aws.amazon.com/AmazonECS/latest/developerguide/get-set-up-for-amazon-ecs.html#create-an-iam-role">Make IAM role for container instances and services</a> (automatically done for me when using the console).</dt>

<dt>Run the PHP example container from <a href="http://docs.aws.amazon.com/AmazonECS/latest/developerguide/docker-basics.html">AWS</a></dt>
<dd>
<ul>
<li>use starcluster to start basic linux instance: <code>starcluster -c http://bheavner.github.io/testconfig/ start -c tiny benCluster</code></li>
<li>log in to master node: <code>starcluster -c http://bheavner.github.io/testconfig/ sshmaster benCluster</code></li>
<li> update packages, grab docker: 
<br><code>sudo yum update -y
<br>sudo yum install -y docker
<br>sudo service docker start
<br>sudo usermod -a -G docker ec2-user</code>
<br> Log out and log back in again to pick up the new docker group permissions.

... and of course the starcluster image doesn't have yum... it's a ubuntu running 3.8.0-35-generic kernel. So have to update kernel and apt to get docker running.
</ul>
</dd>

<dt>Upgrade kernal and apt</dt>
<dd>
<ul>
<li><code>sudo apt-get update</code></li>
<li><code> sudo apt-get install linux-image-generic-lts-trusty</code></li>
</ul>
</dd>

<dt> give up on starcluster approach.</dt>
<dd> The latest public Starcluster AMI includes Ubuntu 13.04, which isn't supported by Docker. If we just want to run Rstudio server, we don't need clustercfn or starcluster. Instead, I'll just fire up a linux instance without the cluster management stuff.
</dl>
</p>

<h3><a id="r-studiobioconductor-on-aws" class="anchor" href="#r-studiobioconduct    or-on-aws" aria-hidden="true"><span class="octicon octicon-link"></span></a>So, demo with a little instance:</h3>
<p>
<dl>
<dt> Launch a t2.micro Amazon Linux instance</dt>
<dd> Follow <a href = "http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/launching-instance.html">these instructions</a>.

<dt>now Run the PHP example container from <a href="http://docs.aws.amazon.com/AmazonECS/latest/developerguide/docker-basics.html">AWS</a></dt>
<dd>And it behaves as expected!</dd>

<dt> Try the R Studio server/bioconductor package</dt>
<dd> Follow <a href = "https://www.bioconductor.org/help/docker/"> the bioconductor instructions</a></dd>

</dl>

<p>Complicate it a bit - fire up the R Studio server with a local volume available to the container for read/write:
<dl>
<dt>We'll need to change permissions so container isn't running as root</dt>
<dd>There are instructions at the <a href="https://github.com/rocker-org/rocker/wiki/Sharing-files-with-host-machine">Rocker Documentation Site</a></dd>
</dl>
</p>

<h3><a id="r-studiobioconductor-on-aws" class="anchor" href="#r-studiobiocon    duct    or-on-aws" aria-hidden="true"><span class="octicon octicon-link"></s    pan></a>Make a task definition and register it with ECS:</h3>


<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>These are pretty much <a href="https://github.com/bheavner" class="user-mention">@bheavner</a>'s notes. </p>
        </section>

        <footer>
          Aws projects is maintained by <a href="https://github.com/bheavner">bheavner</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>
